# 🚌校园巴士 - 工作日 (2020年9月15日更新)

## 欣园 → 科研楼（共157班）

**欣园**⇋**慧园**⇋（荔园←）【创园⇋】（慧园←）**荔园**⇋**学生宿舍**⇋【社康中心⇋】**教工餐厅**⇋【专家公寓⇋三号门⇋一号门⇋行政楼⇋】**七号门**⇋**科研楼**

* （此区间，单向停靠）
* 【此区间，高峰线越站】

<ClientOnly>

<div id="bus-table-hl2rb">
    <table class="dataTable" id="work-bus-hl2rb">
    </table>
</div>
</ClientOnly>

## 科研楼 → 欣园（共156班）

<ClientOnly>
<div id="bus-table-rb2hl">
    <table class="dataTable" id="work-bus-rb2hl">
    </table>
</div>
</ClientOnly>


## 智园 → 教工食堂 → 荔园（共2班）

<ClientOnly>
<div id="bus-table-ip2lh">
    <table class="dataTable" id="work-bus-ip2lh">
    </table>
</div>
</ClientOnly>

![线路图](https://assets.sustech.online/img/campus-map/%E5%8D%97%E6%96%B9%E7%A7%91%E6%8A%80%E5%A4%A7%E5%AD%A6%E6%A0%A1%E5%9B%AD%E5%B7%B4%E5%A3%AB%E7%BA%BF%E8%B7%AF%E5%9B%BE-20200916.jpg)

## 参考文献

* 2020年9月15日 `校园服务办公室 <ocs@sustech.edu.cn>` 邮件《【工作通知】关于调整校园巴士运行时刻的通知 Notice on Adjustment of Campus Bus Schedule and Routes【2020】38号》
    * [下载链接-中文](https://cdn.jsdelivr.net/gh/sustc/sustech-online-ng@master/docs/transport/Campus_Bus_Schedule_2020_09_CN.pdf)（右键 / 长按保存）
    * [Download-English](https://cdn.jsdelivr.net/gh/sustc/sustech-online-ng@master/docs/transport/Campus_Bus_Schedule_2020_09_EN.pdf)（Right click / long press to save）

<script>
  export default {
    mounted () {
function getTime(MinBefore) {
    // 获取x分钟前的时间
    var date = new Date();
    date.setMinutes(date.getMinutes() - MinBefore);
    var h = date.getHours();
    var hour = (h < 10) ? "0" + h : h;
    var m = date.getMinutes();
    var min = (m < 10) ? "0" + m : m;
    return hour + ":" + min;
}

function update_bus_status(bus_time_table) {
    var now_20 = getTime(20);
    var now = getTime(0);
    var now_row_index = 0;
    for (var i = 0, len = bus_time_table.length; i < len; i++) {
        if (bus_time_table[i][0] < now_20) {
            bus_time_table[i][2] = "已到达";
            now_row_index = i;
        } else if (bus_time_table[i][0] < now) {
            bus_time_table[i][2] = "在途中";
        } else {
            bus_time_table[i][2] = "未发车";
        }
    }
    return { "row": now_row_index, "now_table": bus_time_table }
}

// 欣园 → 科研楼
var busdata_hl2rb = [
    ["7:00", "", ""],
    ["7:05", "", ""],
    ["7:10", "", ""],
    ["7:15", "高峰", ""],
    ["7:20", "", ""],
    ["7:23", "高峰", ""],
    ["7:26", "高峰", ""],
    ["7:29", "", ""],
    ["7:32", "高峰", ""],
    ["7:36", "高峰", ""],
    ["7:39", "高峰", ""],
    ["7:42", "高峰", ""],
    ["7:45", "高峰", ""],
    ["7:48", "高峰", ""],
    ["7:51", "高峰", ""],
    ["7:54", "高峰", ""],
    ["7:57", "高峰", ""],
    ["8:00", "", ""],
    ["8:05", "", ""],
    ["8:10", "", ""],
    ["8:15", "", ""],
    ["8:18", "", ""],
    ["8:21", "", ""],
    ["8:24", "", ""],
    ["8:27", "", ""],
    ["8:30", "", ""],
    ["8:35", "", ""],
    ["8:40", "", ""],
    ["8:45", "", ""],
    ["8:48", "", ""],
    ["8:51", "", ""],
    ["8:54", "", ""],
    ["8:57", "", ""],
    ["9:00", "", ""],
    ["9:05", "", ""],
    ["9:10", "", ""],
    ["9:15", "", ""],
    ["9:20", "", ""],
    ["9:25", "", ""],
    ["9:30", "", ""],
    ["9:35", "", ""],
    ["9:40", "", ""],
    ["9:43", "高峰", ""],
    ["9:46", "高峰", ""],
    ["9:50", "", ""],
    ["9:53", "高峰", ""],
    ["9:56", "高峰", ""],
    ["10:00", "", ""],
    ["10:05", "", ""],
    ["10:10", "", ""],
    ["10:15", "", ""],
    ["10:20", "", ""],
    ["10:30", "", ""],
    ["10:40", "", ""],
    ["10:50", "", ""],
    ["11:00", "", ""],
    ["11:10", "", ""],
    ["11:20", "", ""],
    ["11:30", "", ""],
    ["11:35", "", ""],
    ["11:40", "", ""],
    ["11:45", "", ""],
    ["11:50", "", ""],
    ["11:55", "", ""],
    ["12:00", "", ""],
    ["12:05", "高峰", ""],
    ["12:10", "", ""],
    ["12:15", "高峰", ""],
    ["12:20", "", ""],
    ["12:23", "高峰", ""],
    ["12:26", "高峰", ""],
    ["12:30", "", ""],
    ["12:35", "高峰", ""],
    ["12:40", "", ""],
    ["12:50", "", ""],
    ["13:00", "", ""],
    ["13:05", "", ""],
    ["13:10", "", ""],
    ["13:20", "", ""],
    ["13:23", "高峰", ""],
    ["13:26", "高峰", ""],
    ["13:30", "", ""],
    ["13:33", "高峰", ""],
    ["13:36", "高峰", ""],
    ["13:40", "", ""],
    ["13:45", "高峰", ""],
    ["13:50", "", ""],
    ["13:55", "高峰", ""],
    ["14:00", "", ""],
    ["14:10", "", ""],
    ["14:20", "", ""],
    ["14:30", "", ""],
    ["14:40", "", ""],
    ["14:50", "", ""],
    ["15:00", "", ""],
    ["15:10", "", ""],
    ["15:20", "", ""],
    ["15:30", "", ""],
    ["15:35", "", ""],
    ["15:40", "高峰", ""],
    ["15:50", "", ""],
    ["15:53", "高峰", ""],
    ["15:56", "高峰", ""],
    ["16:00", "", ""],
    ["16:05", "高峰", ""],
    ["16:10", "", ""],
    ["16:20", "", ""],
    ["16:30", "", ""],
    ["16:40", "", ""],
    ["16:50", "", ""],
    ["17:00", "", ""],
    ["17:10", "", ""],
    ["17:15", "", ""],
    ["17:20", "", ""],
    ["17:23", "", ""],
    ["17:26", "", ""],
    ["17:30", "", ""],
    ["17:33", "", ""],
    ["17:36", "", ""],
    ["17:40", "", ""],
    ["17:43", "", ""],
    ["17:46", "", ""],
    ["17:50", "", ""],
    ["17:53", "", ""],
    ["17:56", "", ""],
    ["18:00", "", ""],
    ["18:03", "", ""],
    ["18:06", "", ""],
    ["18:10", "", ""],
    ["18:13", "", ""],
    ["18:16", "", ""],
    ["18:20", "", ""],
    ["18:23", "高峰", ""],
    ["18:26", "高峰", ""],
    ["18:30", "", ""],
    ["18:35", "", ""],
    ["18:40", "", ""],
    ["18:45", "", ""],
    ["18:50", "", ""],
    ["18:55", "", ""],
    ["19:00", "", ""],
    ["19:10", "", ""],
    ["19:20", "", ""],
    ["19:30", "", ""],
    ["19:40", "", ""],
    ["19:50", "", ""],
    ["20:00", "", ""],
    ["20:15", "", ""],
    ["20:30", "", ""],
    ["20:45", "", ""],
    ["21:00", "", ""],
    ["21:20", "", ""],
    ["21:40", "", ""],
    ["22:00", "", ""],
    ["22:15", "", ""],
    ["22:30", "", ""],
    ["22:40", "", ""],
];

// 科研楼 → 欣园
var busdata_rb2hl = [
    ["7:20", "", ""],
    ["7:25", "", ""],
    ["7:30", "", ""],
    ["7:35", "高峰", ""],
    ["7:40", "", ""],
    ["7:43", "高峰", ""],
    ["7:46", "", ""],
    ["7:50", "", ""],
    ["7:55", "高峰", ""],
    ["8:00", "", ""],
    ["8:05", "", ""],
    ["8:10", "", ""],
    ["8:13", "", ""],
    ["8:16", "", ""],
    ["8:20", "", ""],
    ["8:22", "", ""],
    ["8:25", "", ""],
    ["8:28", "", ""],
    ["8:32", "", ""],
    ["8:34", "", ""],
    ["8:36", "", ""],
    ["8:38", "", ""],
    ["8:42", "", ""],
    ["8:45", "", ""],
    ["8:48", "", ""],
    ["8:51", "", ""],
    ["8:54", "", ""],
    ["8:57", "", ""],
    ["9:00", "", ""],
    ["9:03", "", ""],
    ["9:06", "", ""],
    ["9:10", "", ""],
    ["9:15", "", ""],
    ["9:20", "", ""],
    ["9:25", "", ""],
    ["9:30", "", ""],
    ["9:35", "", ""],
    ["9:40", "", ""],
    ["9:45", "", ""],
    ["9:50", "", ""],
    ["9:53", "高峰", ""],
    ["9:56", "高峰", ""],
    ["10:00", "", ""],
    ["10:03", "高峰", ""],
    ["10:06", "高峰", ""],
    ["10:10", "", ""],
    ["10:15", "", ""],
    ["10:20", "", ""],
    ["10:30", "", ""],
    ["10:40", "", ""],
    ["10:45", "", ""],
    ["10:50", "", ""],
    ["11:00", "", ""],
    ["11:10", "", ""],
    ["11:20", "", ""],
    ["11:30", "", ""],
    ["11:35", "", ""],
    ["11:40", "", ""],
    ["11:45", "", ""],
    ["11:50", "", ""],
    ["11:55", "", ""],
    ["12:00", "", ""],
    ["12:05", "高峰", ""],
    ["12:10", "", ""],
    ["12:13", "高峰", ""],
    ["12:16", "高峰", ""],
    ["12:20", "", ""],
    ["12:25", "高峰", ""],
    ["12:30", "", ""],
    ["12:33", "高峰", ""],
    ["12:36", "高峰", ""],
    ["12:40", "", ""],
    ["12:45", "", ""],
    ["12:50", "高峰", ""],
    ["12:55", "", ""],
    ["13:00", "", ""],
    ["13:05", "", ""],
    ["13:10", "", ""],
    ["13:15", "", ""],
    ["13:20", "", ""],
    ["13:25", "", ""],
    ["13:35", "", ""],
    ["13:40", "", ""],
    ["13:45", "高峰", ""],
    ["13:50", "", ""],
    ["13:53", "高峰", ""],
    ["13:56", "高峰", ""],
    ["14:00", "", ""],
    ["14:05", "", ""],
    ["14:10", "", ""],
    ["14:15", "高峰", ""],
    ["14:20", "", ""],
    ["14:30", "", ""],
    ["14:40", "", ""],
    ["14:50", "", ""],
    ["15:00", "", ""],
    ["15:10", "", ""],
    ["15:20", "", ""],
    ["15:30", "", ""],
    ["15:40", "", ""],
    ["15:45", "", ""],
    ["15:50", "高峰", ""],
    ["15:55", "", ""],
    ["16:00", "", ""],
    ["16:03", "高峰", ""],
    ["16:06", "高峰", ""],
    ["16:10", "", ""],
    ["16:20", "", ""],
    ["16:30", "", ""],
    ["16:40", "", ""],
    ["16:50", "", ""],
    ["17:00", "", ""],
    ["17:10", "", ""],
    ["17:15", "", ""],
    ["17:20", "", ""],
    ["17:25", "", ""],
    ["17:30", "", ""],
    ["17:35", "", ""],
    ["17:40", "", ""],
    ["17:45", "", ""],
    ["17:50", "", ""],
    ["17:55", "", ""],
    ["18:00", "", ""],
    ["18:05", "高峰", ""],
    ["18:10", "", ""],
    ["18:13", "高峰", ""],
    ["18:16", "高峰", ""],
    ["18:20", "", ""],
    ["18:23", "", ""],
    ["18:26", "高峰", ""],
    ["18:30", "", ""],
    ["18:35", "", ""],
    ["18:40", "高峰", ""],
    ["18:50", "", ""],
    ["19:00", "", ""],
    ["19:10", "", ""],
    ["19:20", "", ""],
    ["19:30", "", ""],
    ["19:40", "", ""],
    ["19:50", "", ""],
    ["20:00", "", ""],
    ["20:20", "", ""],
    ["20:40", "", ""],
    ["20:55", "高峰", ""],
    ["21:00", "", ""],
    ["21:03", "高峰", ""],
    ["21:10", "", ""],
    ["21:20", "", ""],
    ["21:40", "", ""],
    ["21:53", "高峰", ""],
    ["21:56", "高峰", ""],
    ["22:00", "", ""],
    ["22:10", "高峰", ""],
    ["22:30", "", ""],
    ["22:45", "", ""],
    ["23:00", "", ""],
];

// 智园 → 教工食堂
var busdata_ip2lh = [
    ["11:50", "", ""],
    ["17:45", "", ""],
];


function build_all_table() {
    if ($.fn.DataTable.isDataTable('#hl2rb')) {
        return;
    }

    var dtb_config = {
        scrollY: 300,
        paging: false,
        searching: false,
        bFilter: false,
        info: false,
        columns: [
            { title: "发车时间" },
            { title: "平时/高峰", "orderable": false },
            { title: "状态", "orderable": false },
        ],
        rowCallback: function (row, data, index) {
            if (data[2] == "已到达") {
                $('td', row).css('background-color', '#003f43'); // SUSTech dark green
                $('td', row).css('color', '#FFFFFF');
            }
            else if (data[2] == "未发车") {
                $('td', row).css('background-color', '#FFFFFF'); // SUSTech dark green
                $('td', row).css('color', '#2c3e50');
            }            
            else if (data[2] == "在途中") {
                $('td', row).css('background-color', '#ed6c00'); // SUSTech orange
                $('td', row).each(function () {
                    $(this).html('<b>' + $(this).text() + '</b>');
                });
            }
        }
    }
    
    // high land - research building
    var tmp = update_bus_status(busdata_hl2rb);
    busdata_hl2rb = tmp.now_table;
    var now_bus_row_hl2rb = tmp.row;
    var ins_table_hl2rb = $('#work-bus-hl2rb').DataTable($.extend(true, { data: busdata_hl2rb }, dtb_config));
    var now_bus_offset = $(ins_table_hl2rb.row(Math.min(now_bus_row_hl2rb, busdata_hl2rb.length)).node()).offset().top - $(ins_table_hl2rb.row(0).node()).offset().top;
    $("#bus-table-hl2rb .dataTables_scrollBody").scrollTop(now_bus_offset);
    
    // research building - high land
    var tmp = update_bus_status(busdata_rb2hl);
    busdata_rb2hl = tmp.now_table;
    var now_bus_row_rb2hl = tmp.row;
    var ins_table_rb2hl = $('#work-bus-rb2hl').DataTable($.extend(true, { data: busdata_rb2hl }, dtb_config));
    var now_bus_offset = $(ins_table_rb2hl.row(Math.min(now_bus_row_rb2hl, busdata_rb2hl.length)).node()).offset().top - $(ins_table_rb2hl.row(0).node()).offset().top;
    $("#bus-table-rb2hl .dataTables_scrollBody").scrollTop(now_bus_offset);
    
    // i park - lychee hill
    var tmp = update_bus_status(busdata_ip2lh);
    busdata_ip2lh = tmp.now_table;
    var now_bus_row_ip2lh = tmp.row;
    var ins_table_ip2lh = $('#work-bus-ip2lh').DataTable($.extend(true, { data: busdata_ip2lh }, dtb_config));
    var now_bus_offset = $(ins_table_ip2lh.row(Math.min(now_bus_row_ip2lh, busdata_ip2lh.length)).node()).offset().top - $(ins_table_ip2lh.row(0).node()).offset().top;
    $("#bus-table-ip2lh .dataTables_scrollBody").scrollTop(now_bus_offset);
}

document.addEventListener('DOMContentLoaded', build_all_table, false);

$(document).ready(function () {
    build_all_table();
});
    }
  }
</script>
