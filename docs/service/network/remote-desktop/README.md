# 校内远程桌面使用指北

by [@jerrylususu](https://github.com/jerrylususu)

::: tip

本文写于2020年12月。

:::

## 远程桌面是什么？

远程桌面，是一种远程访问技术，可以从其他设备连接到你的电脑，并访问所有应用、文件和资源，就像坐在自己的电脑前一样。简而言之，这是一项可以把不属于自己的设备当成自己的设备使用的技术。

作为一项技术，远程桌面有不同的实现。在 Windows 环境下，最常见的远程桌面实现为 Remote Desktop Protocol （RDP，远程桌面协议），Windows 为其提供了完善的支持。在 Linux 环境下，最常见的远程桌面实现为 Virtual Network Computing （VNC）。其他厂家也有自己的远程桌面实现，如 TeamViewer, AnyDesk, ToDesk, 向日葵, 甚至于 QQ 的「远程协助」。本文将着眼于 Windows 环境下 RDP 的配置，这也是校内最常见的用例。

## 远程桌面的典型使用场景

* 购买了重量较重的游戏本或不便于携带的台式机在宿舍，但是想从图书馆、实验室等位置使用。
* 在参加计算机系的实验课程时，使用宿舍或实验室内性能强大的设备进行编译操作，而不必被机房性能羸弱的电脑限制。
* 在图书馆专心复习时，仍能访问宿舍电脑上存储的课件、笔记、电子书等资料。
* 在教室 Pre 的时候发现自己忘了携带所需的资料，可以使用远程桌面从宿舍电脑上取回。
* 在校内有 WiFi 信号覆盖的位置使用远程桌面连接回宿舍电脑继续工作/学习，而无需手动维持不同设备（如笔记本和台式机）间的数据同步状态。
* 在宿舍床上使用 iPad 等平板类设备游玩床下电脑中的 Galgame。

## 不建议使用远程桌面的场景

* 玩大型游戏、看电影/视频（RDP 主要为日常工作使用优化，变化频繁的画面使用 Steam Remote Play 等技术更适合）
* 复制体积较大的文件（RDP 对在不同设备间转移小文件十分合适，但文件体积过大可能造成网络阻塞，操作卡死）

> 下称自己的设备为「服务端」，机房/教室/图书馆等的设备为「客户端」

## 服务端配置

1. [开启「远程桌面」功能。](https://support.microsoft.com/zh-cn/windows/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2-5fe128d5-8fb1-7a23-3b8a-41e636865e8c)（此功能需要专业版本 Windows，家庭版本可以使用 GitHub 上的开源工具 [RDPWrap](https://github.com/stascorp/rdpwrap) 开启此功能，[教程](https://www.iplaysoft.com/rdp-wrapper-library.html))。
2. [设置远程桌面端口为非 3389 端口]，并记住这个端口号(https://docs.microsoft.com/zh-cn/windows-server/remote/remote-desktop-services/clients/change-listening-port) （此为信息中心的限制，为防止病毒通过远程桌面传播，默认阻断了 3389 端口上的 TCP 链接）
3. 查看并记录自己的 IP 地址：打开「任务管理器」，切换到「性能」标签页，在左侧找到「Wi-Fi」，在右侧找到「IPv4 地址」并记录。（通常为以小数点分割的一组数字，如 `10.XX.XX.XX`）

## 从客户端连接

1. 在「开始」菜单中选择「Windows 附件 / 远程桌面」（或使用 `Win+R` 打开「运行」窗口，然后输入 `mstsc`，按下回车）
2. 在「计算机」文本框中输入自己的 IP 和端口号，用英文冒号分割。（例：`10.XX.XX.XX:YYYY`）
3. 点击「连接」按钮
4. 在弹出的认证窗口中输入自己的用户名和密码（如果服务端使用的是微软账户，需要输入微软账户的邮箱和密码）
5. 在证书确认窗口点击「是」
6. 如果一切正常，应该能见到远程设备的桌面了。

## 图书馆的小技巧

在南科大的三个图书馆中，都有公共的电脑区域，使用此区域的电脑作为远程桌面的客户端也是不错的选择。不同图书馆间电脑对比如下表。

| 图书馆 | 电脑设备数（约） | 操作系统   | 屏幕分辨率      | 连接速度 |
| ------ | ---------- | ---------- | --------------- | -------- |
| 琳恩   | ~50        | Windows 7  | 1080p, 100% DPI | 百兆     |
| 一丹   | ~100       | Windows 10 | 1080p, 125% DPI | 千兆     |
| 涵泳   | ~10        | Windows 10 | 1080p, 125% DPI | 千兆     |


在图书馆使用远程桌面的时候，以下几点可以帮助你获得更好的体验：

1. 如果觉得卡顿，可以在连接前在「体验」标签页中设置连接速度为 `WAN （10 Mbps 或更高速度，高延迟）` ，并取消勾选「拖动时显示窗口内容」和「菜单和窗口动画」。
2. 可以携带一条有线耳机插入主机的前端耳机插口（通常为绿色），以在远程桌面中使从服务端获取音频（听歌）。注意每次连接的时候远端设备音量会被设置为 100。
3. 使用完成后，在关闭远程桌面之外，最好手动关机/重启公用电脑。即使登出了公用电脑（恢复输入学号/密码界面），远程桌面的连接信息（IP，用户名）依然会保存在远程桌面应用中，存在泄露个人信息的可能。
4. 可以安装一个其他远程桌面软件（笔者自己使用 ToDesk）备用，以防因网络波动导致服务端 IP 改变无法连接。

> 注：在图书馆如果不想远程桌面，但是却想用公用电脑的屏幕，可以携带一根 HDMI 转 DVI 转接线。三个图书馆的公用电脑的屏幕的接口均为 VGA + DVI，其中 VGA 接口连接主机，DVI 接口未连接。不建议为了使用屏幕而手动拔开连接主机的 VGA 线，这回为图书馆的维护人员带来困扰。


